/*
 * qp.c
 *
 *  Created on: 12.07.2021
 *      Author: mguerreiro
 *
 */

//=============================================================================
/*-------------------------------- Includes ---------------------------------*/
//=============================================================================
#include "qpfxp_cpp.h"

#include <ap_fixed.h>

#include "benchmarking_zynq.h"

typedef ap_fixed<64,32> fmint_t;

#define QPFXP_LAMBDA_SIZE	32
#define QPFXP_N_ITERS		5

//=============================================================================

//#define QPFXP_LAMBDA_SIZE	32
//#define QPFXP_N_ITERS		10

//=============================================================================
/*-------------------------------- Functions --------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
/* Using xilinx fixed point only, solver accepts floating point parameters */
uint32_t qpfxpHildFixedIterHLSCpp(float *K_float, float *lambda_float, uint32_t *t_exec){

	static fmint_t H[32][32] = {{-5.5428230572379482e-04,-6.5432767421356944e-14,-2.9675766781374700e+03,
			   1.3424807245970419e+02, 8.4003680561291276e+02,-1.0527137053509247e+02,
			   1.7614662892406045e+03,-1.9195824765525094e+02,-1.8041348058083445e+03,
			   6.5432767421356944e-14, 2.9675766781374700e+03,-1.3424807245970419e+02,
			  -8.4003680561291276e+02, 1.0527137053509247e+02,-1.7614662892406045e+03,
			   1.9195824765525094e+02,-6.7557320273823635e+01, 1.3830821489446672e+00,
			   5.9052099390063219e+01,-4.1032220429365625e+00, 2.1620497162792770e+01,
			  -1.2132118735128679e+00,-5.9144868881728641e+01, 8.4426825462187693e+00,
			   6.7557320273823635e+01,-1.3830821489446672e+00,-5.9052099390063219e+01,
			   4.1032220429365625e+00,-2.1620497162792770e+01, 1.2132118735128679e+00,
			   5.9144868881728641e+01,-8.4426825462187693e+00},
			 { 1.3385292306075474e-14,-5.5428230572378842e-04,-1.3424807245970561e+02,
			  -2.9675766781375164e+03, 1.0527137053509486e+02, 8.4003680561294277e+02,
			   1.9195824765525401e+02, 1.7614662892406543e+03,-1.3385292306075474e-14,
			  -1.8041348058083654e+03, 1.3424807245970561e+02, 2.9675766781375164e+03,
			  -1.0527137053509486e+02,-8.4003680561294277e+02,-1.9195824765525401e+02,
			  -1.7614662892406543e+03,-1.3830821489446807e+00,-6.7557320273824416e+01,
			   4.1032220429366157e+00, 5.9052099390064349e+01, 1.2132118735128377e+00,
			   2.1620497162792550e+01,-8.4426825462189683e+00,-5.9144868881730780e+01,
			   1.3830821489446807e+00, 6.7557320273824416e+01,-4.1032220429366157e+00,
			  -5.9052099390064349e+01,-1.2132118735128377e+00,-2.1620497162792550e+01,
			   8.4426825462189683e+00, 5.9144868881730780e+01},
			 {-2.9675766781374755e+03,-1.3424807245970558e+02,-1.3093664488711591e-04,
			   2.9274360713316128e-12,-6.1337731994852584e+03, 3.2535090938511701e+02,
			  -7.8792410807039632e+03, 4.1015824799453304e+02, 2.9675766781374755e+03,
			   1.3424807245970558e+02,-7.6372813803357149e+03,-2.9274360713316128e-12,
			   6.1337731994852584e+03,-3.2535090938511701e+02, 7.8792410807039632e+03,
			  -4.1015824799453304e+02, 1.1122628062413726e+02, 2.7520325433346833e+00,
			  -2.0026484397071457e+02, 4.4602747267824912e+00, 6.2733151045215827e+01,
			  -6.4210883618415791e+00, 3.7094910945133711e+02,-3.1266201650402561e+01,
			  -1.1122628062413726e+02,-2.7520325433346833e+00, 2.0026484397071457e+02,
			  -4.4602747267824912e+00,-6.2733151045215827e+01, 6.4210883618415791e+00,
			  -3.7094910945133711e+02, 3.1266201650402561e+01},
			 { 1.3424807245970391e+02,-2.9675766781375164e+03, 3.3821834222180769e-12,
			  -1.3093664488711434e-04,-3.2535090938512451e+02,-6.1337731994853184e+03,
			  -4.1015824799454356e+02,-7.8792410807040633e+03,-1.3424807245970391e+02,
			   2.9675766781375164e+03,-3.3821834222180769e-12,-7.6372813803358076e+03,
			   3.2535090938512451e+02, 6.1337731994853184e+03, 4.1015824799454356e+02,
			   7.8792410807040633e+03,-2.7520325433345896e+00, 1.1122628062413879e+02,
			  -4.4602747267826759e+00,-2.0026484397071692e+02, 6.4210883618416723e+00,
			   6.2733151045216097e+01, 3.1266201650403154e+01, 3.7094910945134120e+02,
			   2.7520325433345896e+00,-1.1122628062413879e+02, 4.4602747267826759e+00,
			   2.0026484397071692e+02,-6.4210883618416723e+00,-6.2733151045216097e+01,
			  -3.1266201650403154e+01,-3.7094910945134120e+02},
			 { 8.4003680561292458e+02, 1.0527137053509531e+02,-6.1337731994852784e+03,
			  -3.2535090938512440e+02,-8.7776351568851974e-05, 2.9558577807620168e-12,
			   5.6805447241781003e+03, 2.1093837206956863e+02,-8.4003680561292458e+02,
			  -1.0527137053509531e+02, 6.1337731994852784e+03, 3.2535090938512440e+02,
			  -1.1392590169524165e+04,-2.9558577807620168e-12,-5.6805447241781003e+03,
			  -2.1093837206956863e+02,-3.1536576030127463e+01,-3.2979862510540894e+00,
			   2.0554960709008594e+02, 5.9378371799121430e+00,-2.6455333136007772e+02,
			   6.8987216461380800e+00,-4.4129026527497325e+02, 1.1378005385264954e+01,
			   3.1536576030127463e+01, 3.2979862510540894e+00,-2.0554960709008594e+02,
			  -5.9378371799121430e+00, 2.6455333136007772e+02,-6.8987216461380800e+00,
			   4.4129026527497325e+02,-1.1378005385264954e+01},
			 {-1.0527137053509267e+02, 8.4003680561294277e+02, 3.2535090938511740e+02,
			  -6.1337731994853148e+03, 2.6147972675971687e-12,-8.7776351568851865e-05,
			  -2.1093837206955851e+02, 5.6805447241781112e+03, 1.0527137053509267e+02,
			  -8.4003680561294277e+02,-3.2535090938511740e+02, 6.1337731994853148e+03,
			  -2.6147972675971687e-12,-1.1392590169524179e+04, 2.1093837206955851e+02,
			  -5.6805447241781112e+03, 3.2979862510539766e+00,-3.1536576030128142e+01,
			  -5.9378371799119609e+00, 2.0554960709008677e+02,-6.8987216461381156e+00,
			  -2.6455333136007761e+02,-1.1378005385265382e+01,-4.4129026527497359e+02,
			  -3.2979862510539766e+00, 3.1536576030128142e+01, 5.9378371799119609e+00,
			  -2.0554960709008677e+02, 6.8987216461381156e+00, 2.6455333136007761e+02,
			   1.1378005385265382e+01, 4.4129026527497359e+02},
			 { 1.7614662892406113e+03, 1.9195824765525430e+02,-7.8792410807039714e+03,
			  -4.1015824799454327e+02, 5.6805447241780921e+03,-2.1093837206955803e+02,
			  -2.0383585603949004e-05, 8.4980911196907982e-12,-1.7614662892406113e+03,
			  -1.9195824765525430e+02, 7.8792410807039714e+03, 4.1015824799454327e+02,
			  -5.6805447241780921e+03, 2.1093837206955803e+02,-4.9059082117832375e+04,
			  -8.4980911196907982e-12,-6.6106721014125824e+01,-5.8376636831817219e+00,
			   2.4427951025985436e+02, 6.9121164791860341e+00,-1.6700490117706845e+01,
			   9.9176356404210129e+00,-1.8806606034409942e+03, 4.7376197276500847e+01,
			   6.6106721014125824e+01, 5.8376636831817219e+00,-2.4427951025985436e+02,
			  -6.9121164791860341e+00, 1.6700490117706845e+01,-9.9176356404210129e+00,
			   1.8806606034409942e+03,-4.7376197276500847e+01},
			 {-1.9195824765525077e+02, 1.7614662892406545e+03, 4.1015824799453225e+02,
			  -7.8792410807040596e+03, 2.1093837206956971e+02, 5.6805447241781112e+03,
			   9.0381035988684744e-12,-2.0383585603949008e-05, 1.9195824765525077e+02,
			  -1.7614662892406545e+03,-4.1015824799453225e+02, 7.8792410807040596e+03,
			  -2.1093837206956971e+02,-5.6805447241781112e+03,-9.0381035988684744e-12,
			  -4.9059082117832368e+04, 5.8376636831815567e+00,-6.6106721014127444e+01,
			  -6.9121164791857339e+00, 2.4427951025985641e+02,-9.9176356404211337e+00,
			  -1.6700490117705836e+01,-4.7376197276501614e+01,-1.8806606034409938e+03,
			  -5.8376636831815567e+00, 6.6106721014127444e+01, 6.9121164791857339e+00,
			  -2.4427951025985641e+02, 9.9176356404211337e+00, 1.6700490117705836e+01,
			   4.7376197276501614e+01, 1.8806606034409938e+03},
			 {-1.8041348058083445e+03, 6.5432767421356944e-14, 2.9675766781374700e+03,
			  -1.3424807245970419e+02,-8.4003680561291276e+02, 1.0527137053509247e+02,
			  -1.7614662892406045e+03, 1.9195824765525094e+02,-5.5428230572379482e-04,
			  -6.5432767421356944e-14,-2.9675766781374700e+03, 1.3424807245970419e+02,
			   8.4003680561291276e+02,-1.0527137053509247e+02, 1.7614662892406045e+03,
			  -1.9195824765525094e+02, 6.7557320273823635e+01,-1.3830821489446672e+00,
			  -5.9052099390063219e+01, 4.1032220429365625e+00,-2.1620497162792770e+01,
			   1.2132118735128679e+00, 5.9144868881728641e+01,-8.4426825462187693e+00,
			  -6.7557320273823635e+01, 1.3830821489446672e+00, 5.9052099390063219e+01,
			  -4.1032220429365625e+00, 2.1620497162792770e+01,-1.2132118735128679e+00,
			  -5.9144868881728641e+01, 8.4426825462187693e+00},
			 {-1.3385292306075474e-14,-1.8041348058083654e+03, 1.3424807245970561e+02,
			   2.9675766781375164e+03,-1.0527137053509486e+02,-8.4003680561294277e+02,
			  -1.9195824765525401e+02,-1.7614662892406543e+03, 1.3385292306075474e-14,
			  -5.5428230572378842e-04,-1.3424807245970561e+02,-2.9675766781375164e+03,
			   1.0527137053509486e+02, 8.4003680561294277e+02, 1.9195824765525401e+02,
			   1.7614662892406543e+03, 1.3830821489446807e+00, 6.7557320273824416e+01,
			  -4.1032220429366157e+00,-5.9052099390064349e+01,-1.2132118735128377e+00,
			  -2.1620497162792550e+01, 8.4426825462189683e+00, 5.9144868881730780e+01,
			  -1.3830821489446807e+00,-6.7557320273824416e+01, 4.1032220429366157e+00,
			   5.9052099390064349e+01, 1.2132118735128377e+00, 2.1620497162792550e+01,
			  -8.4426825462189683e+00,-5.9144868881730780e+01},
			 { 2.9675766781374755e+03, 1.3424807245970558e+02,-7.6372813803357149e+03,
			  -2.9274360713316128e-12, 6.1337731994852584e+03,-3.2535090938511701e+02,
			   7.8792410807039632e+03,-4.1015824799453304e+02,-2.9675766781374755e+03,
			  -1.3424807245970558e+02,-1.3093664488711591e-04, 2.9274360713316128e-12,
			  -6.1337731994852584e+03, 3.2535090938511701e+02,-7.8792410807039632e+03,
			   4.1015824799453304e+02,-1.1122628062413726e+02,-2.7520325433346833e+00,
			   2.0026484397071457e+02,-4.4602747267824912e+00,-6.2733151045215827e+01,
			   6.4210883618415791e+00,-3.7094910945133711e+02, 3.1266201650402561e+01,
			   1.1122628062413726e+02, 2.7520325433346833e+00,-2.0026484397071457e+02,
			   4.4602747267824912e+00, 6.2733151045215827e+01,-6.4210883618415791e+00,
			   3.7094910945133711e+02,-3.1266201650402561e+01},
			 {-1.3424807245970391e+02, 2.9675766781375164e+03,-3.3821834222180769e-12,
			  -7.6372813803358076e+03, 3.2535090938512451e+02, 6.1337731994853184e+03,
			   4.1015824799454356e+02, 7.8792410807040633e+03, 1.3424807245970391e+02,
			  -2.9675766781375164e+03, 3.3821834222180769e-12,-1.3093664488711434e-04,
			  -3.2535090938512451e+02,-6.1337731994853184e+03,-4.1015824799454356e+02,
			  -7.8792410807040633e+03, 2.7520325433345896e+00,-1.1122628062413879e+02,
			   4.4602747267826759e+00, 2.0026484397071692e+02,-6.4210883618416723e+00,
			  -6.2733151045216097e+01,-3.1266201650403154e+01,-3.7094910945134120e+02,
			  -2.7520325433345896e+00, 1.1122628062413879e+02,-4.4602747267826759e+00,
			  -2.0026484397071692e+02, 6.4210883618416723e+00, 6.2733151045216097e+01,
			   3.1266201650403154e+01, 3.7094910945134120e+02},
			 {-8.4003680561292458e+02,-1.0527137053509531e+02, 6.1337731994852784e+03,
			   3.2535090938512440e+02,-1.1392590169524165e+04,-2.9558577807620168e-12,
			  -5.6805447241781003e+03,-2.1093837206956863e+02, 8.4003680561292458e+02,
			   1.0527137053509531e+02,-6.1337731994852784e+03,-3.2535090938512440e+02,
			  -8.7776351568851974e-05, 2.9558577807620168e-12, 5.6805447241781003e+03,
			   2.1093837206956863e+02, 3.1536576030127463e+01, 3.2979862510540894e+00,
			  -2.0554960709008594e+02,-5.9378371799121430e+00, 2.6455333136007772e+02,
			  -6.8987216461380800e+00, 4.4129026527497325e+02,-1.1378005385264954e+01,
			  -3.1536576030127463e+01,-3.2979862510540894e+00, 2.0554960709008594e+02,
			   5.9378371799121430e+00,-2.6455333136007772e+02, 6.8987216461380800e+00,
			  -4.4129026527497325e+02, 1.1378005385264954e+01},
			 { 1.0527137053509267e+02,-8.4003680561294277e+02,-3.2535090938511740e+02,
			   6.1337731994853148e+03,-2.6147972675971687e-12,-1.1392590169524179e+04,
			   2.1093837206955851e+02,-5.6805447241781112e+03,-1.0527137053509267e+02,
			   8.4003680561294277e+02, 3.2535090938511740e+02,-6.1337731994853148e+03,
			   2.6147972675971687e-12,-8.7776351568851865e-05,-2.1093837206955851e+02,
			   5.6805447241781112e+03,-3.2979862510539766e+00, 3.1536576030128142e+01,
			   5.9378371799119609e+00,-2.0554960709008677e+02, 6.8987216461381156e+00,
			   2.6455333136007761e+02, 1.1378005385265382e+01, 4.4129026527497359e+02,
			   3.2979862510539766e+00,-3.1536576030128142e+01,-5.9378371799119609e+00,
			   2.0554960709008677e+02,-6.8987216461381156e+00,-2.6455333136007761e+02,
			  -1.1378005385265382e+01,-4.4129026527497359e+02},
			 {-1.7614662892406113e+03,-1.9195824765525430e+02, 7.8792410807039714e+03,
			   4.1015824799454327e+02,-5.6805447241780921e+03, 2.1093837206955803e+02,
			  -4.9059082117832375e+04,-8.4980911196907982e-12, 1.7614662892406113e+03,
			   1.9195824765525430e+02,-7.8792410807039714e+03,-4.1015824799454327e+02,
			   5.6805447241780921e+03,-2.1093837206955803e+02,-2.0383585603949004e-05,
			   8.4980911196907982e-12, 6.6106721014125824e+01, 5.8376636831817219e+00,
			  -2.4427951025985436e+02,-6.9121164791860341e+00, 1.6700490117706845e+01,
			  -9.9176356404210129e+00, 1.8806606034409942e+03,-4.7376197276500847e+01,
			  -6.6106721014125824e+01,-5.8376636831817219e+00, 2.4427951025985436e+02,
			   6.9121164791860341e+00,-1.6700490117706845e+01, 9.9176356404210129e+00,
			  -1.8806606034409942e+03, 4.7376197276500847e+01},
			 { 1.9195824765525077e+02,-1.7614662892406545e+03,-4.1015824799453225e+02,
			   7.8792410807040596e+03,-2.1093837206956971e+02,-5.6805447241781112e+03,
			  -9.0381035988684744e-12,-4.9059082117832368e+04,-1.9195824765525077e+02,
			   1.7614662892406545e+03, 4.1015824799453225e+02,-7.8792410807040596e+03,
			   2.1093837206956971e+02, 5.6805447241781112e+03, 9.0381035988684744e-12,
			  -2.0383585603949008e-05,-5.8376636831815567e+00, 6.6106721014127444e+01,
			   6.9121164791857339e+00,-2.4427951025985641e+02, 9.9176356404211337e+00,
			   1.6700490117705836e+01, 4.7376197276501614e+01, 1.8806606034409938e+03,
			   5.8376636831815567e+00,-6.6106721014127444e+01,-6.9121164791857339e+00,
			   2.4427951025985641e+02,-9.9176356404211337e+00,-1.6700490117705836e+01,
			  -4.7376197276501614e+01,-1.8806606034409938e+03},
			 {-6.7557320273823635e+01,-1.3830821489446778e+00, 1.1122628062413706e+02,
			  -2.7520325433346002e+00,-3.1536576030127023e+01, 3.2979862510539686e+00,
			  -6.6106721014125583e+01, 5.8376636831815629e+00, 6.7557320273823635e+01,
			   1.3830821489446778e+00,-1.1122628062413706e+02, 2.7520325433346002e+00,
			   3.1536576030127023e+01,-3.2979862510539686e+00, 6.6106721014125583e+01,
			  -5.8376636831815629e+00,-3.9513196782503635e-01, 4.9282736645243605e-16,
			  -2.2144003162263188e+00, 1.0837814367068174e-01,-8.1052747182937968e-01,
			   2.8855060749422509e-02, 2.2212008549547564e+00,-2.7080171327564767e-01,
			  -2.5308000400585104e+00,-4.9282736645243605e-16, 2.2144003162263188e+00,
			  -1.0837814367068174e-01, 8.1052747182937968e-01,-2.8855060749422509e-02,
			  -2.2212008549547564e+00, 2.7080171327564767e-01},
			 { 1.3830821489446643e+00,-6.7557320273824416e+01, 2.7520325433346882e+00,
			   1.1122628062413881e+02,-3.2979862510540814e+00,-3.1536576030128145e+01,
			  -5.8376636831817157e+00,-6.6106721014127444e+01,-1.3830821489446643e+00,
			   6.7557320273824416e+01,-2.7520325433346882e+00,-1.1122628062413881e+02,
			   3.2979862510540814e+00, 3.1536576030128145e+01, 5.8376636831817157e+00,
			   6.6106721014127444e+01, 5.9767064252235532e-16,-3.9513196782503174e-01,
			  -1.0837814367068456e-01,-2.2144003162263628e+00,-2.8855060749421214e-02,
			  -8.1052747182937324e-01, 2.7080171327565677e-01, 2.2212008549548372e+00,
			  -5.9767064252235532e-16,-2.5308000400585398e+00, 1.0837814367068456e-01,
			   2.2144003162263628e+00, 2.8855060749421214e-02, 8.1052747182937324e-01,
			  -2.7080171327565677e-01,-2.2212008549548372e+00},
			 { 5.9052099390063425e+01, 4.1032220429366175e+00,-2.0026484397071468e+02,
			  -4.4602747267826670e+00, 2.0554960709008563e+02,-5.9378371799119485e+00,
			   2.4427951025985439e+02,-6.9121164791857552e+00,-5.9052099390063425e+01,
			  -4.1032220429366175e+00, 2.0026484397071468e+02, 4.4602747267826670e+00,
			  -2.0554960709008563e+02, 5.9378371799119485e+00,-2.4427951025985439e+02,
			   6.9121164791857552e+00,-2.2144003162263277e+00,-1.0837814367068445e-01,
			  -1.7258568903592986e-01, 2.5717148698125533e-15,-2.9789496804729043e+00,
			   1.8896330111886794e-01,-1.2195820324022666e+01, 7.4808622203340369e-01,
			   2.2144003162263277e+00, 1.0837814367068445e-01,-5.7942231802998130e+00,
			  -2.5717148698125533e-15, 2.9789496804729043e+00,-1.8896330111886794e-01,
			   1.2195820324022666e+01,-7.4808622203340369e-01},
			 {-4.1032220429365598e+00, 5.9052099390064349e+01, 4.4602747267824814e+00,
			  -2.0026484397071690e+02, 5.9378371799121510e+00, 2.0554960709008694e+02,
			   6.9121164791860457e+00, 2.4427951025985661e+02, 4.1032220429365598e+00,
			  -5.9052099390064349e+01,-4.4602747267824814e+00, 2.0026484397071690e+02,
			  -5.9378371799121510e+00,-2.0554960709008694e+02,-6.9121164791860457e+00,
			  -2.4427951025985661e+02, 1.0837814367068158e-01,-2.2144003162263619e+00,
			   2.7406879566695688e-15,-1.7258568903592819e-01,-1.8896330111887011e-01,
			  -2.9789496804729088e+00,-7.4808622203341912e-01,-1.2195820324022762e+01,
			  -1.0837814367068158e-01, 2.2144003162263619e+00,-2.7406879566695688e-15,
			  -5.7942231802998689e+00, 1.8896330111887011e-01, 2.9789496804729088e+00,
			   7.4808622203341912e-01, 1.2195820324022762e+01},
			 { 2.1620497162792464e+01, 1.2132118735128234e+00, 6.2733151045216502e+01,
			   6.4210883618416741e+00,-2.6455333136007800e+02,-6.8987216461381138e+00,
			  -1.6700490117707147e+01,-9.9176356404211088e+00,-2.1620497162792464e+01,
			  -1.2132118735128234e+00,-6.2733151045216502e+01,-6.4210883618416741e+00,
			   2.6455333136007800e+02, 6.8987216461381138e+00, 1.6700490117707147e+01,
			   9.9176356404211088e+00,-8.1052747182937013e-01,-2.8855060749420864e-02,
			  -2.9789496804729168e+00,-1.8896330111886978e-01,-1.2979269623698905e-01,
			  -1.4351679315465732e-16, 6.8652834812588051e+00, 1.1340449124143795e-01,
			   8.1052747182937013e-01, 2.8855060749420864e-02, 2.9789496804729168e+00,
			   1.8896330111886978e-01,-7.7045937790990608e+00, 1.4351679315465732e-16,
			  -6.8652834812588051e+00,-1.1340449124143795e-01},
			 {-1.2132118735128552e+00, 2.1620497162792550e+01,-6.4210883618416164e+00,
			   6.2733151045216090e+01, 6.8987216461381111e+00,-2.6455333136007744e+02,
			   9.9176356404210431e+00,-1.6700490117705669e+01, 1.2132118735128552e+00,
			  -2.1620497162792550e+01, 6.4210883618416164e+00,-6.2733151045216090e+01,
			  -6.8987216461381111e+00, 2.6455333136007744e+02,-9.9176356404210431e+00,
			   1.6700490117705669e+01, 2.8855060749421992e-02,-8.1052747182937335e-01,
			   1.8896330111886872e-01,-2.9789496804729043e+00,-8.1629803399909312e-16,
			  -1.2979269623698927e-01,-1.1340449124143810e-01, 6.8652834812587411e+00,
			  -2.8855060749421992e-02, 8.1052747182937335e-01,-1.8896330111886872e-01,
			   2.9789496804729043e+00, 8.1629803399909312e-16,-7.7045937790990484e+00,
			   1.1340449124143810e-01,-6.8652834812587411e+00},
			 {-5.9144868881729153e+01,-8.4426825462189914e+00, 3.7094910945133796e+02,
			   3.1266201650403154e+01,-4.4129026527497280e+02,-1.1378005385265382e+01,
			  -1.8806606034409942e+03,-4.7376197276501550e+01, 5.9144868881729153e+01,
			   8.4426825462189914e+00,-3.7094910945133796e+02,-3.1266201650403154e+01,
			   4.4129026527497280e+02, 1.1378005385265382e+01, 1.8806606034409942e+03,
			   4.7376197276501550e+01, 2.2212008549547759e+00, 2.7080171327565722e-01,
			  -1.2195820324022678e+01,-7.4808622203341857e-01, 6.8652834812587802e+00,
			  -1.1340449124143631e-01,-1.2946163727550640e-02, 1.3920445981739292e-14,
			  -2.2212008549547759e+00,-2.7080171327565722e-01, 1.2195820324022678e+01,
			   7.4808622203341857e-01,-6.8652834812587802e+00, 1.1340449124143631e-01,
			  -7.7242959462339186e+01,-1.3920445981739292e-14},
			 { 8.4426825462187853e+00,-5.9144868881730780e+01,-3.1266201650402586e+01,
			   3.7094910945134114e+02, 1.1378005385264927e+01,-4.4129026527497348e+02,
			   4.7376197276500861e+01,-1.8806606034409938e+03,-8.4426825462187853e+00,
			   5.9144868881730780e+01, 3.1266201650402586e+01,-3.7094910945134114e+02,
			  -1.1378005385264927e+01, 4.4129026527497348e+02,-4.7376197276500861e+01,
			   1.8806606034409938e+03,-2.7080171327564828e-01, 2.2212008549548368e+00,
			   7.4808622203340369e-01,-1.2195820324022749e+01, 1.1340449124143891e-01,
			   6.8652834812587447e+00, 1.3949440786712988e-14,-1.2946163727550643e-02,
			   2.7080171327564828e-01,-2.2212008549548368e+00,-7.4808622203340369e-01,
			   1.2195820324022749e+01,-1.1340449124143891e-01,-6.8652834812587447e+00,
			  -1.3949440786712988e-14,-7.7242959462339158e+01},
			 { 6.7557320273823635e+01, 1.3830821489446778e+00,-1.1122628062413706e+02,
			   2.7520325433346002e+00, 3.1536576030127023e+01,-3.2979862510539686e+00,
			   6.6106721014125583e+01,-5.8376636831815629e+00,-6.7557320273823635e+01,
			  -1.3830821489446778e+00, 1.1122628062413706e+02,-2.7520325433346002e+00,
			  -3.1536576030127023e+01, 3.2979862510539686e+00,-6.6106721014125583e+01,
			   5.8376636831815629e+00,-2.5308000400585104e+00,-4.9282736645243605e-16,
			   2.2144003162263188e+00,-1.0837814367068174e-01, 8.1052747182937968e-01,
			  -2.8855060749422509e-02,-2.2212008549547564e+00, 2.7080171327564767e-01,
			  -3.9513196782503635e-01, 4.9282736645243605e-16,-2.2144003162263188e+00,
			   1.0837814367068174e-01,-8.1052747182937968e-01, 2.8855060749422509e-02,
			   2.2212008549547564e+00,-2.7080171327564767e-01},
			 {-1.3830821489446643e+00, 6.7557320273824416e+01,-2.7520325433346882e+00,
			  -1.1122628062413881e+02, 3.2979862510540814e+00, 3.1536576030128145e+01,
			   5.8376636831817157e+00, 6.6106721014127444e+01, 1.3830821489446643e+00,
			  -6.7557320273824416e+01, 2.7520325433346882e+00, 1.1122628062413881e+02,
			  -3.2979862510540814e+00,-3.1536576030128145e+01,-5.8376636831817157e+00,
			  -6.6106721014127444e+01,-5.9767064252235532e-16,-2.5308000400585398e+00,
			   1.0837814367068456e-01, 2.2144003162263628e+00, 2.8855060749421214e-02,
			   8.1052747182937324e-01,-2.7080171327565677e-01,-2.2212008549548372e+00,
			   5.9767064252235532e-16,-3.9513196782503174e-01,-1.0837814367068456e-01,
			  -2.2144003162263628e+00,-2.8855060749421214e-02,-8.1052747182937324e-01,
			   2.7080171327565677e-01, 2.2212008549548372e+00},
			 {-5.9052099390063425e+01,-4.1032220429366175e+00, 2.0026484397071468e+02,
			   4.4602747267826670e+00,-2.0554960709008563e+02, 5.9378371799119485e+00,
			  -2.4427951025985439e+02, 6.9121164791857552e+00, 5.9052099390063425e+01,
			   4.1032220429366175e+00,-2.0026484397071468e+02,-4.4602747267826670e+00,
			   2.0554960709008563e+02,-5.9378371799119485e+00, 2.4427951025985439e+02,
			  -6.9121164791857552e+00, 2.2144003162263277e+00, 1.0837814367068445e-01,
			  -5.7942231802998130e+00,-2.5717148698125533e-15, 2.9789496804729043e+00,
			  -1.8896330111886794e-01, 1.2195820324022666e+01,-7.4808622203340369e-01,
			  -2.2144003162263277e+00,-1.0837814367068445e-01,-1.7258568903592986e-01,
			   2.5717148698125533e-15,-2.9789496804729043e+00, 1.8896330111886794e-01,
			  -1.2195820324022666e+01, 7.4808622203340369e-01},
			 { 4.1032220429365598e+00,-5.9052099390064349e+01,-4.4602747267824814e+00,
			   2.0026484397071690e+02,-5.9378371799121510e+00,-2.0554960709008694e+02,
			  -6.9121164791860457e+00,-2.4427951025985661e+02,-4.1032220429365598e+00,
			   5.9052099390064349e+01, 4.4602747267824814e+00,-2.0026484397071690e+02,
			   5.9378371799121510e+00, 2.0554960709008694e+02, 6.9121164791860457e+00,
			   2.4427951025985661e+02,-1.0837814367068158e-01, 2.2144003162263619e+00,
			  -2.7406879566695688e-15,-5.7942231802998689e+00, 1.8896330111887011e-01,
			   2.9789496804729088e+00, 7.4808622203341912e-01, 1.2195820324022762e+01,
			   1.0837814367068158e-01,-2.2144003162263619e+00, 2.7406879566695688e-15,
			  -1.7258568903592819e-01,-1.8896330111887011e-01,-2.9789496804729088e+00,
			  -7.4808622203341912e-01,-1.2195820324022762e+01},
			 {-2.1620497162792464e+01,-1.2132118735128234e+00,-6.2733151045216502e+01,
			  -6.4210883618416741e+00, 2.6455333136007800e+02, 6.8987216461381138e+00,
			   1.6700490117707147e+01, 9.9176356404211088e+00, 2.1620497162792464e+01,
			   1.2132118735128234e+00, 6.2733151045216502e+01, 6.4210883618416741e+00,
			  -2.6455333136007800e+02,-6.8987216461381138e+00,-1.6700490117707147e+01,
			  -9.9176356404211088e+00, 8.1052747182937013e-01, 2.8855060749420864e-02,
			   2.9789496804729168e+00, 1.8896330111886978e-01,-7.7045937790990608e+00,
			   1.4351679315465732e-16,-6.8652834812588051e+00,-1.1340449124143795e-01,
			  -8.1052747182937013e-01,-2.8855060749420864e-02,-2.9789496804729168e+00,
			  -1.8896330111886978e-01,-1.2979269623698905e-01,-1.4351679315465732e-16,
			   6.8652834812588051e+00, 1.1340449124143795e-01},
			 { 1.2132118735128552e+00,-2.1620497162792550e+01, 6.4210883618416164e+00,
			  -6.2733151045216090e+01,-6.8987216461381111e+00, 2.6455333136007744e+02,
			  -9.9176356404210431e+00, 1.6700490117705669e+01,-1.2132118735128552e+00,
			   2.1620497162792550e+01,-6.4210883618416164e+00, 6.2733151045216090e+01,
			   6.8987216461381111e+00,-2.6455333136007744e+02, 9.9176356404210431e+00,
			  -1.6700490117705669e+01,-2.8855060749421992e-02, 8.1052747182937335e-01,
			  -1.8896330111886872e-01, 2.9789496804729043e+00, 8.1629803399909312e-16,
			  -7.7045937790990484e+00, 1.1340449124143810e-01,-6.8652834812587411e+00,
			   2.8855060749421992e-02,-8.1052747182937335e-01, 1.8896330111886872e-01,
			  -2.9789496804729043e+00,-8.1629803399909312e-16,-1.2979269623698927e-01,
			  -1.1340449124143810e-01, 6.8652834812587411e+00},
			 { 5.9144868881729153e+01, 8.4426825462189914e+00,-3.7094910945133796e+02,
			  -3.1266201650403154e+01, 4.4129026527497280e+02, 1.1378005385265382e+01,
			   1.8806606034409942e+03, 4.7376197276501550e+01,-5.9144868881729153e+01,
			  -8.4426825462189914e+00, 3.7094910945133796e+02, 3.1266201650403154e+01,
			  -4.4129026527497280e+02,-1.1378005385265382e+01,-1.8806606034409942e+03,
			  -4.7376197276501550e+01,-2.2212008549547759e+00,-2.7080171327565722e-01,
			   1.2195820324022678e+01, 7.4808622203341857e-01,-6.8652834812587802e+00,
			   1.1340449124143631e-01,-7.7242959462339186e+01,-1.3920445981739292e-14,
			   2.2212008549547759e+00, 2.7080171327565722e-01,-1.2195820324022678e+01,
			  -7.4808622203341857e-01, 6.8652834812587802e+00,-1.1340449124143631e-01,
			  -1.2946163727550640e-02, 1.3920445981739292e-14},
			 {-8.4426825462187853e+00, 5.9144868881730780e+01, 3.1266201650402586e+01,
			  -3.7094910945134114e+02,-1.1378005385264927e+01, 4.4129026527497348e+02,
			  -4.7376197276500861e+01, 1.8806606034409938e+03, 8.4426825462187853e+00,
			  -5.9144868881730780e+01,-3.1266201650402586e+01, 3.7094910945134114e+02,
			   1.1378005385264927e+01,-4.4129026527497348e+02, 4.7376197276500861e+01,
			  -1.8806606034409938e+03, 2.7080171327564828e-01,-2.2212008549548368e+00,
			  -7.4808622203340369e-01, 1.2195820324022749e+01,-1.1340449124143891e-01,
			  -6.8652834812587447e+00,-1.3949440786712988e-14,-7.7242959462339158e+01,
			  -2.7080171327564828e-01, 2.2212008549548368e+00, 7.4808622203340369e-01,
			  -1.2195820324022749e+01, 1.1340449124143891e-01, 6.8652834812587447e+00,
			   1.3949440786712988e-14,-1.2946163727550643e-02}};

	fmint_t *h;
	fmint_t *k;
    fmint_t acc;

    fmint_t K[QPFXP_LAMBDA_SIZE];
    fmint_t lambda[QPFXP_LAMBDA_SIZE];

    uint32_t t1, t2;

	uint32_t i, j, m;

	t1 = GetTicks();
	for(i = 0; i < QPFXP_LAMBDA_SIZE; i++){
		//K[i] = fmint_t(K_float[i]);
		//lambda[i] = 0;
		K[i].V.VAL = (int64_t)(K_float[i] * ((int64_t)(1LL << 32)) );
		lambda[i].V.VAL = 0;
	}
	t1 = t1 - GetTicks();

	k = K;
	for(m = 0; m < QPFXP_N_ITERS; m++){

		h = (fmint_t *)H;

		/* One iteration through the lambda vector */
		for(i = 0; i < QPFXP_LAMBDA_SIZE; i++){

			lambda[i] = 0;
            acc = 0;
			for(j = 0; j < QPFXP_LAMBDA_SIZE; j++){
				acc += h[j] * lambda[j];
			}

			lambda[i] = h[i] * (k[i] + acc);
			if( lambda[i] < 0 ) lambda[i] = 0;

			h = h + QPFXP_LAMBDA_SIZE;
		}
	}

	t2 = GetTicks();
	for(i = 0; i < QPFXP_LAMBDA_SIZE; i++){
		lambda_float[i] = lambda[i].to_float();
	}
	t2 = t2 - GetTicks();
	if(t_exec) *t_exec = t1;

	return QPFXP_N_ITERS;
}
//-----------------------------------------------------------------------------
//=============================================================================
